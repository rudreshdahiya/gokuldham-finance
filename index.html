<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gokuldham Society Analysis</title>
    <!-- SENTRY SDK (CDN) -->
    <script src="https://browser.sentry-cdn.com/7.100.0/bundle.min.js"
        integrity="sha384-Hkca5C0d+91e4L4y8l61P9z4y3F5310574768340" crossorigin="anonymous"></script>
    <script src="https://browser.sentry-cdn.com/7.100.0/rewrites.min.js"></script>
    <!-- CRASH REPORTER (Must be first) -->
    <script src="crash_reporter.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles_v3.css">
    <!-- THREE.JS Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap"
        rel="stylesheet">
</head>

<body>

    <!-- ==============================================
         SCREEN 1: SPLASH (THE HOOK)
         ============================================== -->
    <div id="ui-splash" class="ui-screen">
        <div class="splash-content">
            <div class="logo-area">
                <div class="logo-box">G</div>
                <h1>GOKULDHAM<br><span style="font-weight:300; font-size:0.6em; letter-spacing:3px;">FINANCIAL
                        SOCIETY</span></h1>
                <p style="font-size:0.8em; color:#888; margin-top:10px;">Managed by A. Bhide (Ekmeva Secretary)</p>
            </div>

            <div class="splash-status">
                <div class="status-item">
                    <span class="status-dot green"></span> Abdul's Shop: OPEN
                </div>
                <div class="status-item">
                    <span class="status-dot orange"></span> Jethalal: LATE
                </div>
            </div>
            <p class="desc">Where Tradition Meets Technology. Discover your financial destiny.</p>
            <button id="btn-splash-init" class="primary-btn pulse-btn" onclick="goToInput()">>
                OPEN_VAULT.EXE</button>
        </div>
    </div>

    <!-- ==============================================
         SCREEN 2: DATA TERMINAL (THE INPUT)
         ============================================== -->
    <div id="ui-input" class="ui-screen hidden">
        <div class="terminal-window" id="input-terminal">
            <div class="terminal-header">
                <div class="buttons">
                    <div class="red"></div>
                    <div class="yellow"></div>
                    <div class="green"></div>
                </div>
                <div class="header-logo">Gokuldham Bank</div>
                <div style="position:absolute; right:20px; top:20px;">
                    <button id="auth-btn"
                        style="background:#3498db; color:white; border:none; padding:8px 15px; border-radius:4px; cursor:pointer; font-family:'Courier New';">☁️
                        Sign In</button>
                </div>
            </div>
            <div class="terminal-body">
                <div class="console-log">
                    <span class="green">> SYSTEM:</span> Initializing Finance Engine...<br>
                    <span class="green">> STATE:</span> Waiting for user inputs...<br>
                    <span class="blue">> INFO:</span> Ideally, this data comes from your AA (Account Aggregator). For
                    now, tell us your estimates.<br><br>
                </div>

                <form id="finance-form">
                    <!-- 1. PERSONAL DETAILS -->
                    <div class="form-group-row">
                        <div class="form-group">
                            <label>AGE BRACKET</label>
                            <select id="input-age" onchange="updateGoals()">
                                <option value="18-22">18 - 22 (Student)</option>
                                <option value="22-28">22 - 28 (Young Pro)</option>
                                <option value="29-39" selected>29 - 39 (Mid Career)</option>
                                <option value="40-60">40 - 60 (Pre-Retire)</option>
                                <option value="60+">60+ (Retired)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>STATE (For Inflation Index)</label>
                            <select id="input-state">
                                <!-- Populated via JS -->
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>MONTHLY INCOME (₹)</label>
                        <input type="number" id="input-monthly-income" placeholder="e.g. 100000"
                            oninput="updateTotal()">
                    </div>

                    <div class="form-group">
                        <label>FINANCIAL GOALS (Select Multiple)</label>
                        <div id="goal-pills-container" class="goal-pills-wrapper">
                            <!-- Dynamic Content injected by JS -->
                        </div>
                        <div id="goal-primers" class="primer-text">Hover over a goal to see details.</div>
                    </div>

                    <div class="divider"></div>
                    <div class="section-title">MONTHLY SPEND BREAKDOWN (%)</div>
                    <div class="section-subtitle">Allocate your income in percentages. Total must be 100%.</div>

                    <div class="split-view">
                        <div class="left-inputs">
                            <!-- Needs -->
                            <div class="slider-group">
                                <label>Groceries <span class="calc-amt" id="amt-groceries">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-groceries" min="0" max="100" value="15"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-groceries">15%</span>
                                </div>
                            </div>
                            <div class="slider-group">
                                <label>Utilities <span class="calc-amt" id="amt-utilities">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-utilities" min="0" max="100" value="5"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-utilities">5%</span>
                                </div>
                            </div>
                            <div class="slider-group">
                                <label>Rent <span class="calc-amt" id="amt-rent">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-rent" min="0" max="100" value="20"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-rent">20%</span>
                                </div>
                            </div>
                            <div class="slider-group">
                                <label>Loan EMIs <span class="calc-amt" id="amt-emi">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-emi" min="0" max="100" value="10"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-emi">10%</span>
                                </div>
                            </div>
                            <div class="slider-group">
                                <label>Health <span class="calc-amt" id="amt-health">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-health" min="0" max="100" value="5"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-health">5%</span>
                                </div>
                            </div>
                            <div class="slider-group">
                                <label>Credit Card / Debt <span class="calc-amt" id="amt-debt">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-debt" min="0" max="100" value="0"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-debt">0%</span>
                                </div>
                            </div>

                            <!-- Wants -->
                            <div class="slider-group">
                                <label>Dining Out <span class="calc-amt" id="amt-dining">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-dining" min="0" max="100" value="10"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-dining">10%</span>
                                </div>
                            </div>
                            <div class="slider-group">
                                <label>Travel <span class="calc-amt" id="amt-travel">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-travel" min="0" max="100" value="10"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-travel">10%</span>
                                </div>
                            </div>
                            <div class="slider-group">
                                <label>Shopping <span class="calc-amt" id="amt-shopping">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-shopping" min="0" max="100" value="10"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-shopping">10%</span>
                                </div>
                            </div>
                            <div class="slider-group">
                                <label>Entertainment <span class="calc-amt" id="amt-entertainment">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-entertainment" min="0" max="100" value="5"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-entertainment">5%</span>
                                </div>
                            </div>

                            <!-- Savings -->
                            <div class="slider-group savings-group">
                                <label>Savings & Investments <span class="calc-amt" id="amt-savings">₹0</span></label>
                                <div class="slider-row">
                                    <input type="range" id="slider-savings" min="0" max="100" value="10"
                                        oninput="updateTotal(event)">
                                    <span class="slider-val" id="val-savings">10%</span>
                                </div>
                            </div>
                        </div>

                        <div class="right-vis">
                            <div class="chart-container">
                                <canvas id="spendChart"></canvas>
                            </div>
                            <div class="total-status" id="total-display">TOTAL: 100%</div>
                        </div>
                    </div>

                    <button type="button" class="btn-process" onclick="analyzeProfile()">RUN_DIAGNOSTIC_V10.1</button>
                </form>
            </div>
        </div>
    </div>

    <!-- ==============================================
         SCREEN 3: PROCESSING MATRIX (The Calculation)
         ============================================== -->
    <div id="ui-processing" class="ui-screen hidden">
        <div class="processing-terminal construction-zone">
            <div class="proc-header">
                <div>⚠️ SOCIETY MAINTENANCE IN PROGRESS ⚠️</div>
                <div class="voxel-loader"></div>
            </div>
            <div class="voxel-bar-container">
                <div class="voxel-bar-fill" id="proc-bar"></div>
            </div>
            <div class="proc-body" id="console-output" style="margin-top:20px;">
                <!-- Javascript injects logs here -->
            </div>
        </div>
    </div>

    <!-- ==============================================
         SCREEN 4: THE PASSPORT (The Result)
         ============================================== -->
    <div id="ui-result" class="ui-screen hidden">
        <!-- Content Injected via JS -->
    </div>

    <!-- 3D BACKGROUND LAYER -->
    <div id="canvas-container"></div>

    <div id="canvas-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- SUPABASE SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- STACK AUTH SDK (Using global bundle if available, otherwise we might need a workaround or simple fetch) -->
    <!-- Note: Stack Auth usually requires a bundler. For vanilla JS, we might fallback to basic fetch or assume simple layout -->
    <script src="https://unpkg.com/@stackframe/js-core"></script>

    <script src="data_engine.js"></script>
    <script src="data_engine.js"></script>
    <script src="macro_data.js"></script>
    <script src="macro_data.js"></script>
    <script src="services_stub.js"></script>
    <script src="forensics_engine.js"></script>
    <script src="cloud_services.js"></script>
    <script src="script.js"></script>
</body>

</html>