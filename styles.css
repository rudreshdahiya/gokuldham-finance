@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap');

:root {
    /* HELLO FRIEND NG THEME - Source: _variables.scss */
    --bg-color: #232425;
    --bg-secondary: #3b3d42;
    --bg-header: #1b1c1d;

    --text-main: #a9a9b3;
    --text-secondary: #b3b3bd;
    --border-color: #4e4e57;

    /* Accents (Kept from Fintech Theme as Hello Friend is neutral) */
    --accent: #ffcd00;
    --accent-secondary: #fe5186;

    /* Fonts */
    --font-ui: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    --font-mono: 'Fira Code', Consolas, Monaco, monospace;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html,
body {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    /* Prevent global scroll */
}

body {
    margin: 0;
    overflow: hidden;
    background-color: var(--bg-color);
    font-family: var(--font-ui);
    color: var(--text-main);
    /* Generous line height */
    letter-spacing: 0.02em;
    /* Subtle spacing */
}

/* Headings use Serif */
h1,
h2,
h3 {
    font-family: var(--font-body);
    /* Serif */
    margin-top: 0;
    line-height: 1.3;
    font-weight: normal;
    /* Elegant feel */
}

/* ... existing code ... */



.letter-image {
    width: 100%;
    height: auto;
    /* Allow full height */
    display: block;
    border: none;
    border-radius: 6px;
}

.letter-pdf {
    width: 100%;
    height: 800px;
    /* Specific height for PDF reading */
    border: none;
    display: block;
}

/* Extra Gallery Images */
.extra-gallery-img {
    width: 100%;
    max-width: 300px;
    height: auto;
    border-radius: 8px;
    margin-top: 20px;
    border: 1px solid var(--border-color);
}

#ui-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    /* CHANGE: Move layout to the left */
    display: flex;
    align-items: flex-start;
    /* Aligns to top */
    justify-content: flex-start;
    /* Aligns to left */
    padding-left: 5%;
    /* Keep left padding */
    padding-top: 10%;
    /* Add top padding to push it down slightly but keep it high */
}

/* INTRO SCREEN */
/* INTRO SCREEN */
#intro-screen {
    text-align: center;
    max-width: 450px;
    /* Much smaller */
    pointer-events: auto;
    background: transparent;
    padding: 30px;
    /* Reduced padding */
    z-index: 20;
    /* Entry Animation */
    opacity: 0;
    transform: scale(0.9);
    animation: modalEntry 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards 0.5s;
    /* Glassmorphism subtle */
    backdrop-filter: blur(10px);
    border-radius: 20px;

    /* FORCE POSITION TOP LEFT */
    position: absolute;
    top: 5%;
    /* Higher up */
    left: 5%;
    margin: 0;
}

.intro-constellation {
    margin-bottom: 15px;
    /* Tighter */
    opacity: 0;
    animation: slideUpFade 1s ease-out forwards 0.8s;
}

@keyframes modalEntry {
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

h1 {
    font-size: clamp(1.8rem, 4vw, 2.8rem);
    /* Smaller font scale */
    margin-top: 0;
    font-weight: normal;
    font-family: var(--font-body);
    line-height: 1.2;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 15px;
    margin-bottom: 20px;
}

/* COUNTRY VIEW (2D Map Layer) Styles */
#country-view {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-color);
    z-index: 100;
    display: flex;
    flex-direction: column;
}

.country-header {
    position: absolute;
    top: 30px;
    left: 40px;
    display: flex;
    align-items: center;
    gap: 20px;
    z-index: 100;
    width: auto;
    background: transparent;
    border: none;
    box-shadow: none;
    pointer-events: none;
}

/* Ensure children like button are clickable */
.country-header>* {
    pointer-events: auto;
}

#country-name-title {
    margin: 0;
    font-size: 3rem;
    color: var(--text-main);
    text-shadow: 0 4px 10px rgba(0, 0, 0, 0.8);
    font-family: var(--font-body);
}

/* #country-name-title handled above */

#country-map-container {
    flex: 1;
    position: relative;
    overflow: hidden;
    background: var(--bg-color);
}

#country-map-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.6;
}


.interactive-prompt {
    font-size: clamp(1rem, 3vw, 1.25rem);
    color: var(--text-main);
    margin-bottom: 40px;
    line-height: 1.5;
}

.interactive-prompt strong {
    border-bottom: 2px solid var(--text-main);
    padding-bottom: 2px;
    font-weight: normal;
}

.highlight {
    color: var(--text-main);
    font-style: italic;
    font-weight: normal;
    border-bottom: 1px solid var(--accent);
}

.button-container {
    display: flex;
    gap: 20px;
    margin-top: 30px;
}

/* Button Base */
button {
    padding: 15px 30px;
    font-size: 16px;
    cursor: pointer;
    font-family: var(--font-ui);
    transition: all 0.3s ease;
    border-radius: 4px;
    letter-spacing: 1px;
    text-transform: uppercase;
    min-width: 44px;
    /* Touch Friendly */
    min-height: 44px;
    /* Touch Friendly */
}

/* Primary YES */
#btn-yes {
    background: var(--text-main);
    color: #111;
    border: none;
    flex: 2;
    font-weight: bold;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
}

#btn-yes:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(255, 255, 255, 0.3);
    background: #fff;
    text-decoration: none;
}

/* Secondary NO */
#btn-no {
    background: transparent;
    color: var(--text-muted);
    border: 1px solid var(--border-color);
    flex: 1;
}

#btn-no:hover {
    border-color: var(--text-muted);
    color: var(--text-main);
    background: rgba(255, 255, 255, 0.05);
}

/* CUSTOM MODAL STYLES */
.hidden {
    display: none !important;
}

#custom-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

.modal-content {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    padding: 40px;
    text-align: center;
    max-width: 400px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 1);
}

.modal-content h3 {
    margin-top: 0;
    font-weight: normal;
    font-size: 24px;
}

/* UNIVERSAL BACK BUTTON ICON */
.back-icon-img {
    width: 100%;
    /* Fill container */
    height: 100%;
    object-fit: cover;
    /* Rectangular fill */
    display: block;
    pointer-events: none;
    /* Click passes to button */
}

/* #btn-back styles removed in favor of .universal-back-btn */

/* Invert icon color on hover if needed */
#btn-back:hover .back-icon-img {
    filter: invert(1);
}

/* CITY GALLERY OVERLAY */
#city-gallery {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* Persistent Background: Semi-transparent + Blur */
    background: rgba(17, 17, 17, 0.85);
    backdrop-filter: blur(8px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 200;
    padding: 40px;
    box-sizing: border-box;
    pointer-events: auto;
    /* Animation */
    animation: overlayFadeIn 0.5s ease-out;
}

.gallery-header {
    width: 100%;
    max-width: 900px;
    display: flex;
    justify-content: flex-start;
    /* Group adjacent */
    align-items: center;
    margin-bottom: 40px;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 20px;
    gap: 20px;
    /* Space between Name and X */
}

#gallery-city-name {
    color: var(--text-main);
    font-size: clamp(1.5rem, 5vw, 2.25rem);
    margin: 0;
    font-weight: normal;
    font-family: var(--font-body);
}

.close-btn {
    background: transparent;
    border: 1px solid var(--border-color);
    /* Add border for clickability availability */
    color: var(--text-muted);
    font-size: 24px;
    /* Slightly smaller X */
    cursor: pointer;
    line-height: 1;
    padding: 5px 12px;
    /* Button shape */
    font-family: var(--font-ui);
    font-weight: 300;
    border-radius: 4px;
    transition: all 0.2s;
    min-width: 44px;
    /* Touch Friendly */
    min-height: 44px;
    /* Touch Friendly */
    display: flex;
    align-items: center;
    justify-content: center;
}

.close-btn:hover {
    color: var(--text-main);
    border-color: var(--text-main);
    background: var(--card-bg);
}

/* THE PHOTO GRID */
#gallery-grid {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 30px;
    width: 100%;
    max-width: 1000px;
    max-height: 80vh;
    overflow-y: auto;
    padding-bottom: 50px;
}

.person-card {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 0;
    /* No radius */
    width: 100%;
    max-width: 200px;
    /* Fluid Grid */
    text-align: center;
    padding: 20px;
    transition: transform 0.2s, border-color 0.2s;
    cursor: pointer;
    box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.3);
}

.person-card:hover {
    transform: translateY(-2px);
    border-color: var(--text-muted);
}

.person-thumb {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    /* Circle photo stays */
    object-fit: cover;
    border: none;
    margin-bottom: 15px;
    background-color: var(--card-bg);
    filter: grayscale(100%);
    /* B&W photos for aesthetic */
    transition: filter 0.3s;
}

.person-card:hover .person-thumb {
    filter: grayscale(0%);
}

.person-name {
    font-size: 18px;
    color: var(--text-main);
    margin: 0;
    font-family: var(--font-body);
}

/* PUZZLE STYLES */
#puzzle-container {
    position: absolute;
    top: 0;
    left: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    /* Strict viewport height */
    overflow: hidden;
    /* No scroll */
    /* Persistent Background */
    background: rgba(17, 17, 17, 0.9);
    backdrop-filter: blur(10px);
    z-index: 300;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    pointer-events: auto;
    /* Animation */
    animation: overlayFadeIn 0.5s ease-out;
}

/* Atmospheric Zoom Effect */
#atmosphere-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 25;
    /* Above intro, below cards */
    background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, rgba(200, 220, 255, 0) 70%);
    opacity: 0;
    transform: scale(0.5);
    mix-blend-mode: screen;
}

#atmosphere-overlay.active {
    animation: cloudFlythrough 2.5s ease-in-out forwards;
}

@keyframes cloudFlythrough {
    0% {
        opacity: 0;
        transform: scale(0.5);
    }

    40% {
        opacity: 1;
        transform: scale(1.5);
    }

    80% {
        opacity: 1;
        transform: scale(3);
    }

    100% {
        opacity: 0;
        transform: scale(4);
    }
}

#puzzle-header {
    width: 95%;
    /* Fluid */
    max-width: 800px;
    /* match canvas width approx */
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 15px;
    background: var(--card-bg);
    padding: 15px 25px;
    border-radius: 4px;
    box-sizing: border-box;
}

#puzzle-timer {
    font-size: 20px;
    font-family: var(--font-ui);
    color: var(--text-main);
    font-weight: bold;
    background: var(--bg-color);
    padding: 5px 15px;
    border-radius: 4px;
    border: 1px solid var(--border-color);
}

#puzzle-board {
    /* Dimensions controlled by JS now */
    background: var(--bg-color);
    border: 1px solid var(--border-color);
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    overflow: hidden;
    touch-action: none;
    margin: 0 auto;
    display: inline-block;
}

.puzzle-controls {
    display: flex;
    gap: 15px;
    align-items: center;
}

#btn-quit {
    background: transparent;
    color: var(--text-muted);
    font-size: 16px;
    padding: 8px 16px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    cursor: pointer;
    font-family: var(--font-ui);
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
    min-width: 44px;
    /* Touch friendly */
    min-height: 44px;
    justify-content: center;
}

#btn-quit:hover {
    color: var(--text-main);
    border-color: var(--text-main);
    background: var(--card-bg);
}

#btn-skip-puzzle {
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-family: var(--font-ui);
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 1px;
    cursor: pointer;
    padding: 10px 15px;
    opacity: 0.6;
    transition: opacity 0.2s;
}

#btn-skip-puzzle:hover {
    opacity: 1;
    color: var(--accent);
    text-decoration: underline;
}


/* SUCCESS POPUP */
#success-popup {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(4px);
    z-index: 400;
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: auto;
    animation: overlayFadeIn 0.3s ease-out;
}

.success-content {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    padding: 50px;
    text-align: center;
    color: var(--text-main);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    max-width: 400px;
    position: relative;
    /* For absolute close button */
}

/* Constellation Delight */
.constellation-wrapper {
    display: flex;
    justify-content: center;
    margin-bottom: 15px;
}

#constellation-svg {
    overflow: visible;
}

.constellation-path {
    fill: none;
    stroke: var(--accent);
    stroke-width: 2;
    stroke-dasharray: 100;
    stroke-dashoffset: 100;
    animation: drawLine 1.5s ease-out forwards 0.5s;
    opacity: 0.8;
}

.star-point {
    fill: #fff;
    opacity: 0;
    animation: starPop 0.5s ease-out forwards;
}

.star-point:nth-child(2) {
    animation-delay: 0.2s;
}

/* First star */
.star-point:nth-child(3) {
    animation-delay: 1.8s;
}

/* Second star after line */

@keyframes drawLine {
    to {
        stroke-dashoffset: 0;
    }
}

@keyframes starPop {
    0% {
        transform: scale(0);
        opacity: 0;
    }

    50% {
        transform: scale(1.5);
        opacity: 1;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.close-popup-btn {
    /* ... existing ... */
    top: 15px;
    right: 20px;
    z-index: 10;
}

.close-popup-btn:hover {
    color: var(--text-main);
}

.success-content h2 {
    color: var(--text-main);
    margin-top: 0;
    font-size: 32px;
    font-weight: normal;
    font-family: var(--font-body);
}

.success-content p {
    font-size: 18px;
    margin: 20px 0 30px 0;
    color: var(--text-muted);
}

.success-content button {
    padding: 12px 30px;
    font-size: 16px;
    background: var(--text-main);
    color: #000;
    border: none;
    border-radius: 2px;
    cursor: pointer;
    font-weight: bold;
    font-family: var(--font-ui);
}

.success-content button:hover {
    background: #fff;
    text-decoration: none;
}


/* PERSON DETAIL OVERLAY */
#person-detail {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    overflow: hidden;
    /* Prevent page scroll */
    padding: 0;
    z-index: 2000;
    display: flex;
    justify-content: center;
    align-items: center;
}

.detail-container {
    background: var(--card-bg);
    border: none;
    width: 100%;
    height: 100%;
    max-width: none;
    /* Full width */
    max-height: none;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Consistent Focus/Hover for Accessed Elements */
button:focus,
a:focus {
    outline: 2px solid var(--text-main);
    outline-offset: 2px;
}

.detail-header {
    padding: 20px 40px;
    border-bottom: 1px solid var(--border-color);
    background: var(--card-bg);
    display: flex;
    align-items: center;
}

/* NEW PROMINENT BACK BUTTON */
.back-nav-btn {
    background: transparent;
    border: 1px solid var(--border-color);
    /* Subtle border define area */
    color: var(--text-main);
    padding: 10px 20px;
    cursor: pointer;
    font-size: 16px;
    font-family: var(--font-ui);
    display: flex;
    align-items: center;
    gap: 10px;
    border-radius: 4px;
    transition: all 0.2s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.back-nav-btn:hover {
    background: var(--text-main);
    color: #000;
    border-color: var(--text-main);
    text-decoration: none;
}

.back-arrow {
    font-size: 20px;
    line-height: 1;
}

.detail-body {
    display: flex;
    flex-direction: column;
    flex: 1;
    /* Take remaining height */
    overflow: hidden;
    padding: 0;
    height: 100%;
}

@media (min-width: 769px) {
    .detail-body {
        flex-direction: row;
        align-items: stretch;
        /* Full height */
    }
}



/* 2-Column Layout */
.detail-left {
    flex: 1;
    /* 50% */
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* Center Vertically */
    align-items: center;
    background: #000;
    border-right: 1px solid var(--border-color);
    padding: 0;
    overflow: hidden;
}

.detail-right {
    flex: 1;
    /* 50% */
    display: flex;
    flex-direction: column;
    padding: 0;
    gap: 15px;
    /* Separation for header */
    background: #111;
    overflow: hidden;
    position: relative;
    border-left: 1px solid var(--border-color);
}

.carousel-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #000;
}

#carousel-img {
    max-width: 95%;
    max-height: 90vh;
    /* Maximize height usage */
    object-fit: contain;
    border-radius: 4px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
    transition: opacity 0.3s ease;
}

.carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.6);
    color: white;
    border: none;
    font-size: 30px;
    padding: 15px 20px;
    cursor: pointer;
    z-index: 10;
    transition: all 0.2s;
    user-select: none;
}

.carousel-btn:hover {
    background: var(--accent);
    color: #000;
}

#carousel-prev {
    left: 0;
}

#carousel-next {
    right: 0;
}



#detail-letter-pdf {
    flex: 1;
    /* Restore Flex behavior */
    width: 100%;
    height: 100%;
    /* Fill the container */
    min-height: 0;
    display: block;
    border: none;
    background: white;
}



@media (max-width: 768px) {

    /* MOBILE PERSON DETAIL */
    .detail-body {
        flex-direction: column;
        padding: 0;
        gap: 0;
    }

    .detail-left {
        flex: none;
        height: 40vh;
        /* Top 40% */
        width: 100%;
        border-bottom: 1px solid var(--border-color);
        border-right: none;
        padding: 0;
    }

    .detail-left img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .detail-right {
        flex: none;
        height: 60vh;
        /* Bottom 60% */
        width: 100%;
        padding: 20px;
    }

    .detail-header {
        position: absolute;
        /* Float header */
        top: 0;
        left: 0;
        width: 100%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(5px);
        z-index: 10;
        border-bottom: none;
    }
}

/* Animations */
@keyframes slideUpFade {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.intro-letter {
    font-family: var(--font-ui);
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--accent);
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    /* Space out items */
    gap: 10px;
    opacity: 0;
    animation: slideUpFade 0.5s ease-out forwards 0.2s;
    /* Stagger 1 */
    padding: 0 10px;
    /* Add some padding */
}

.download-btn {
    font-size: 12px;
    padding: 6px 12px;
    background: var(--accent);
    color: #000;
    text-decoration: none;
    border-radius: 4px;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.2s;
    display: flex;
    align-items: center;
    gap: 5px;
}

.download-btn:hover {
    background: #fff;
    color: #000;
}

.icon-star {
    font-size: 18px;
    color: var(--accent);
}

#detail-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border: none;
}

.letter-container {
    background: transparent;
    padding: 0;
    border: none;
    border-radius: 0;
    box-shadow: none;
    flex: 1;
    /* Grow to fill space */
    flex: 1;
    display: flex;
    /* Restore layout */
    flex-direction: column;
    width: 100%;
    margin-bottom: 0;
    position: relative;
    opacity: 1;
    animation: none;
    overflow-y: auto;
    /* Enable vertical rolling */
    height: 0;
    /* Crucial: Force flex container to use available space, triggering scroll */
    min-height: 0;
}


/* Decorative "Tape" or Accent on Card */
.letter-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 20px;
    width: 40px;
    height: 4px;
    background: var(--accent);
    opacity: 0.5;
}

/* Voice Note Card */
.voice-note-card {
    background: #1a1a1a;
    border: 1px solid var(--border-color);
    padding: 15px 20px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
    opacity: 0;
    animation: slideUpFade 0.6s ease-out forwards 0.6s;
    /* Stagger 3 */
}

.icon-mic {
    font-size: 24px;
    filter: grayscale(1);
}

.audio-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.voice-label {
    font-size: 12px;
    color: var(--text-muted);
    text-transform: uppercase;
    margin-bottom: 5px;
}

#detail-audio {
    width: 100%;
    height: 30px;
    filter: invert(1) hue-rotate(180deg);
    opacity: 0.7;
}

/* CENTRAL WHATSAPP BUTTON */
.whatsapp-btn {
    background: transparent;
    color: #25D366;
    /* Keep WA green for brand? Or make minimal? User asked for 'Make the WhatsApp button stand out.' so maybe Solid Green is still best, or Outline. Let's do Outline Green. */
    text-decoration: none;
    padding: 15px;
    border: 1px solid #25D366;
    border-radius: 4px;
    font-weight: normal;
    text-align: center;
    font-size: 16px;
    font-family: var(--font-ui);
    transition: all 0.2s;
    margin-top: auto;
    /* Push to bottom if space permits */
    display: block;
    /* Full width flow */
    width: 100%;
    box-sizing: border-box;
    opacity: 0;
    animation: slideUpFade 0.6s ease-out forwards 0.8s;
    /* Stagger 4 */
}

.whatsapp-btn:hover {
    background: #25D366;
    color: #000;
}

/* Mobile Responsive & Touch Optimization */
@media (max-width: 768px) {

    /* Touch Targets */
    button,
    .close-btn,
    .back-nav-btn,
    .whatsapp-btn,
    #btn-back,
    #btn-quit,
    .person-card {
        min-height: 44px;
        min-width: 44px;
        /* Apple Human Interface Guidelines */
    }

    /* Intro Screen */
    #intro-screen {
        width: 90%;
        margin: 0 auto;
        /* Center */
        padding: 30px;
    }

    .button-container {
        flex-direction: column-reverse;
        /* YES at bottom for easy thumb access? Or just stack */
    }

    /* Solar System Nav */
    #btn-back {
        bottom: 30px;
        /* Thumb zone */
        width: 80%;
        /* Easy to hit */
        justify-content: center;
    }

    /* City Gallery */
    #city-gallery {
        padding: 20px;
        align-items: stretch;
        /* Full width content */
    }

    .gallery-header {
        justify-content: space-between;
        /* Spread out */
        gap: 10px;
    }

    #gallery-city-name {
        font-size: 28px;
    }

    /* Jigsaw */
    #puzzle-header {
        flex-direction: row;
        /* Keep row but adjust padding */
        padding: 10px;
    }

    #btn-quit span.back-arrow {
        font-size: 24px;
        /* Larger icon */
    }

    /* Person Detail */
    .detail-body {
        flex-direction: column;
        padding: 20px;
        gap: 30px;
    }

    .detail-left {
        flex: none;
        height: 250px;
        width: 100%;
    }

    .detail-right {
        padding-right: 0;
    }

    /* Adjust Letter Card for Mobile */
    .letter-container {
        padding: 1.5em;
        /* Reduce from 2.5em to fit narrow screens */
        font-size: 18px;
        /* Slightly smaller text if needed */
    }

    .detail-container {
        height: 100vh;
        max-height: 100vh;
        width: 100%;
        border-radius: 0;
        border: none;
    }

    /* Thumb Zone CTA */
    .whatsapp-btn {
        margin-top: 20px;
        position: sticky;
        /* Sticky at bottom */
        bottom: 20px;
        z-index: 100;
        /* Ensure visual prominence over content */
        width: 100%;
        /* Full width */
        background: #25D366;
        /* Solid for mobile visibility */
        color: #fff;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        /* Lift it */
    }

    .back-nav-btn {
        padding: 12px 16px;
        /* Larger touch target */
        width: auto;
    }
}

/* NEON DASHBOARD LAYOUT */

/* Background Wrapper */
#neon-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #000;
    background-size: cover;
    background-position: center;
    opacity: 0.4;
    z-index: -1;
    /* Behind content */
    transition: background-image 0.5s ease-in-out;
}

/* Fallback/Overlay Gradient */
#neon-background::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to right, #000 0%, rgba(0, 0, 0, 0.6) 50%, rgba(0, 0, 0, 0.2) 100%);
}

/* CITY VIEW NEW LAYOUT (Floating Glass UI) */
.city-view-layout {
    position: relative;
    width: 100%;
    height: 100%;
    pointer-events: none;
    /* Let clicks pass to map where there is no UI */
}

/* Enforce Hugo Font Class */
.hugo-font {
    font-family: 'Hugo', sans-serif !important;
    /* Ensure Hugo is loaded or fallback */
    /* If Hugo is not a real web font, we use the variable --font-heading or --font-body.
       Assuming --font-body is the primary font here based on previous CSS */
    font-family: var(--font-body) !important;
}

/* BACK BUTTON (Top Left) */
/* UNIVERSAL BACK BUTTON (Standardized) */
.universal-back-btn {
    position: absolute;
    top: 30px;
    left: 40px;
    background: rgba(0, 0, 0, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.2);
    width: 60px;
    /* Rectangular width */
    height: 38px;
    /* Rectangular height */
    border-radius: 12px;
    cursor: pointer;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(5px);
    transition: all 0.3s ease;
    padding: 0;
    overflow: hidden;
    pointer-events: auto;
    /* Fix for unclickable buttons */
}

.universal-back-btn:hover {
    background: #fff;
    transform: scale(1.05);
    border-color: #fff;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
}

.universal-back-btn:hover .back-icon-img {
    filter: invert(1);
    /* Black icon on white bg */
}

/* Country Header adjustments */
/* Consolidated above */

/* Override absolute position when inside country-header flow */
.country-header .universal-back-btn {
    position: static;
    margin: 0;
}

.back-to-country-btn:hover,
#btn-back-earth:hover {
    background: #fff;
    transform: scale(1.1);
}

.back-to-country-btn:hover .back-icon-img,
#btn-back-earth:hover .back-icon-img {
    filter: invert(1);
    /* Black icon on white bg */
}

/* =========================================
   NEW SPLIT LAYOUT (Tailwind-Style)
   ========================================= */

/* Main Container */
/* Main Container */
.city-view-layout {
    position: relative;
    width: 100%;
    height: 100%;
    pointer-events: none;
    /* Pass clicks to map */
    display: flex;
    justify-content: space-between;
    /* Split Left/Right */
    align-items: flex-start;
    /* ALIGN TO TOP */
    padding: 20px;
    box-sizing: border-box;
    /* User requested Card on Left ("Left Top") */
    flex-direction: row-reverse;
}

/* 1. LEFT SIDE: City Intro */
#city-intro-text {
    pointer-events: auto;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    /* Align Top */
    max-width: 500px;
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.8);
}

#gallery-city-name {
    font-family: var(--font-body);
    font-size: 5rem;
    font-weight: 700;
    color: #fff;
    margin: 0;
    line-height: 1;
}

.city-subtitle {
    font-family: var(--font-ui);
    font-size: 1.25rem;
    color: rgba(255, 255, 255, 0.8);
    margin-top: 15px;
    font-weight: 300;
    margin-bottom: 20px;
}

/* Zoom Hint Style */
.zoom-hint {
    display: flex;
    align-items: center;
    gap: 8px;
    font-family: var(--font-ui);
    font-size: 0.9rem;
    color: var(--accent);
    background: rgba(0, 0, 0, 0.6);
    padding: 8px 16px;
    border-radius: 20px;
    align-self: flex-start;
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(4px);
    margin-top: 10px;
}

.zoom-hint::before {
    content: 'üîç';
}

/* 2. RIGHT SIDE: Command Card (<aside>) */
#command-card {
    pointer-events: auto;
    width: 380px;
    /* Slightly narrower */
    height: auto;
    max-height: 90vh;
    /* Strict cap */
    background: rgba(15, 23, 42, 0.9);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    transition: all 0.3s ease;
    /* Ensure it doesn't get pushed out */
    flex-shrink: 1;
}

/* SECTION A: TOP (Connections) */
.card-section-top {
    padding: 15px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    background: rgba(0, 0, 0, 0.2);
    flex-shrink: 0;
}

.section-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    color: var(--accent);
    letter-spacing: 1px;
    font-weight: 600;
    margin-bottom: 10px;
}

#neon-mini-gallery {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding-bottom: 5px;
    scrollbar-width: thin;
}

.mini-thumb {
    width: 48px;
    height: 48px;
    border-radius: 8px;
    opacity: 0.5;
    transition: all 0.2s;
    border: 2px solid transparent;
    cursor: pointer;
    flex-shrink: 0;
    background: #000;
}

.mini-thumb:hover,
.mini-thumb.active {
    opacity: 1;
    transform: scale(1.1);
    border-color: #fff;
}

/* SECTION B: MIDDLE (Content) */
.card-section-middle {
    flex: 1;
    /* Take remaining space */
    overflow-y: auto;
    padding: 0;
    /* Flush image allowed */
    display: flex;
    flex-direction: column;
}

.neon-card-image-wrapper {
    width: 100%;
    height: 180px;
    /* Reduced height significantly */
    flex-shrink: 0;
    position: relative;
}

#neon-main-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.neon-card-content {
    padding: 24px;
}

.person-header-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 10px;
}

#neon-person-name {
    font-size: 2rem;
    margin: 0;
    color: #fff;
    line-height: 1.1;
    font-weight: 600;
}

/* Close Button adjusted */
.close-btn-card {
    background: rgba(255, 255, 255, 0.1);
    width: 50px;
    /* Rectangle */
    height: 36px;
    border-radius: 10px;
    /* Rounded corners */
    border: 1px solid rgba(255, 255, 255, 0.1);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s, transform 0.2s;
    padding: 0;
    overflow: hidden;
}

.close-btn-card:hover {
    background: rgba(255, 255, 255, 1);
    transform: scale(1.1);
}

.close-btn-card:hover .back-icon-img {
    filter: invert(1);
}



#neon-person-desc {
    font-size: 1rem;
    color: rgba(255, 255, 255, 0.7);
    line-height: 1.6;
    margin: 0;
}

/* SECTION C: BOTTOM (Sticky CTA) */
.card-section-bottom {
    padding: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(0, 0, 0, 0.2);
    flex-shrink: 0;
    /* Sticky height */
}

#btn-enter-memory {
    width: 100%;
    padding: 16px;
    border-radius: 99px;
    background: linear-gradient(to right, var(--primary), #6366f1);
    border: none;
    color: #fff;
    font-weight: 700;
    letter-spacing: 1px;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
    transition: transform 0.2s;
    font-size: 0.9rem;
}

#btn-enter-memory:hover {
    transform: scale(1.02);
}

/* =========================================
/* BASE STYLES (Moved from bottom) */
.neon-card {
    display: flex;
    align-items: center;
    gap: 30px;
    /* Reduced gap */
    max-width: 900px;
    width: 100%;
}

.neon-card-image-wrapper {
    flex: 0 0 300px;
    /* Smaller width */
    height: 350px;
    /* Smaller height */
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    /* Reset from previous override if needed */
    width: auto;
    margin-bottom: 0;
}

#neon-main-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
}

.neon-card:hover #neon-main-img {
    transform: scale(1.05);
}

.neon-card-content {
    flex: 1;
    color: #fff;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
}

#neon-person-name {
    font-size: 2.5rem;
    /* Smaller font */
    font-weight: 300;
    margin: 0 0 15px 0;
    font-family: var(--font-body);
    color: #fff;
    line-height: 1.1;
}

#neon-person-desc {
    font-size: 1rem;
    color: #ccc;
    margin-bottom: 25px;
    line-height: 1.5;
    font-family: var(--font-ui);
    max-width: 90%;
}

/* ENTER MEMORY BUTTON */
#btn-enter-memory {
    background: transparent;
    color: var(--accent);
    border: 1px solid var(--accent);
    padding: 18px 40px;
    font-size: 14px;
    letter-spacing: 3px;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.4s ease;
    border-radius: 50px;
    position: relative;
    overflow: hidden;
    font-weight: bold;
    min-width: 44px;
    /* Touch Friendly */
    min-height: 44px;
    /* Touch Friendly */
}

#btn-enter-memory:hover {
    background: var(--accent);
    color: #000;
    box-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
}

/* =========================================
   MOBILE RESPONSIVENESS (Max-Width: 768px)
   ========================================= */
@media screen and (max-width: 768px) {

    /* 1. INTRO SCREEN */
    #intro-screen {
        max-width: 90%;
        top: 5%;
        left: 5%;
        padding: 20px;
    }

    h1 {
        font-size: 2rem;
    }

    .interactive-prompt {
        font-size: 1rem;
    }

    #ui-layer {
        padding-top: 5%;
    }

    /* 2. COUNTRY VIEW */
    .country-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
        top: 20px;
        left: 20px;
    }

    #country-name-title {
        font-size: 2.5rem;
    }

    /* 3. CITY VIEW: BOTTOM SHEET LAYOUT */
    .city-view-layout {
        flex-direction: column;
        /* Stack vertically */
        justify-content: space-between;
        /* Space out */
        padding: 20px;
        align-items: stretch;
    }

    /* Left Side (Now Top) */
    #city-intro-text {
        align-items: flex-start;
        text-align: left;
        margin-top: 40px;
        /* Space for back button */
    }

    #gallery-city-name {
        font-size: 3rem;
    }

    .city-subtitle {
        font-size: 1rem;
    }

    /* Right Side (Card -> Bottom Sheet) */
    #command-card {
        width: 100%;
        max-width: 100%;
        border-radius: 20px 20px 0 0;
        /* Rounded top only */
        max-height: 60vh;
        /* Bottom sheet height */
        position: absolute;
        bottom: 0;
        left: 0;
        border: none;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.5);
    }

    .neon-card-image-wrapper {
        height: 180px;
        /* Smaller image on mobile */
    }

    .card-section-middle {
        padding-bottom: 20px;
        /* Extra scroll space */
    }
}



#btn-enter-memory:hover {
    background: var(--accent);
    color: #000;
    box-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
}

/* COUNTRY VIEW LAYER */
#country-view {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #111;
    z-index: 150;
    /* Below gallery (200), above Earth (0) */
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: overlayFadeIn 0.5s ease-out;
}

.country-header {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    padding: 20px 40px;
    box-sizing: border-box;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 1000;
    /* High z-index to sit above map controls */
    pointer-events: none;
    /* Let clicks pass through to map */
}

.country-header button,
.country-header h2 {
    pointer-events: auto;
}

#btn-back-earth {
    background: rgba(0, 0, 0, 0.5);
    color: var(--text-main);
    border: 1px solid var(--border-color);
    padding: 10px 20px;
    cursor: pointer;
    font-size: 16px;
    font-family: var(--font-ui);
    border-radius: 30px;
    backdrop-filter: blur(4px);
    transition: all 0.2s;
}

#btn-back-earth:hover {
    background: var(--text-main);
    color: #000;
}

#country-name-title {
    color: var(--text-main);
    font-size: 48px;
    margin: 0;
    text-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
    font-family: var(--font-body);
}

#country-map-container {
    flex: 1;
    position: relative;
    width: 100%;
    height: 100%;
    /* Leaflet needs a block container */
    background: #000;
    z-index: 1;
}

/* Hide the static image since we use Leaflet now */
#country-map-img {
    display: none;
}

/* LEAFLET CUSTOM MARKERS */
.neon-pin-icon {
    background: transparent;
    border: none;
}

.pin-dot {
    width: 20px;
    height: 20px;
    background: var(--accent);
    border-radius: 50%;
    box-shadow: 0 0 10px var(--accent), 0 0 20px var(--accent);
    animation: pinPulse 2s infinite;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

.pin-label {
    position: absolute;
    top: -25px;
    /* Above the dot */
    left: 50%;
    transform: translateX(-50%);
    color: #fff;
    font-family: var(--font-ui);
    font-size: 14px;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 1);
    background: rgba(0, 0, 0, 0.6);
    padding: 4px 8px;
    border-radius: 4px;
    white-space: nowrap;
    opacity: 0.8;
    transition: all 0.2s;
}

.neon-pin-icon:hover .pin-dot {
    transform: translate(-50%, -50%) scale(1.3);
    background: #fff;
    box-shadow: 0 0 15px #fff, 0 0 30px var(--accent);
}

.neon-pin-icon:hover .pin-label {
    transform: translateX(-50%) translateY(-5px);
    background: rgba(0, 0, 0, 0.9);
    opacity: 1;
}

@keyframes pinPulse {
    0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
    }

    50% {
        transform: translate(-50%, -50%) scale(1.1);
        opacity: 0.8;
    }

    100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
    }
}

/* CITY MAP BACKGROUND */
#city-map-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    /* Behind neon layout */
    opacity: 0.6;
    /* Slightly dimmed so text pops */
    filter: saturate(1.2) contrast(1.1);
}

#neon-background.hidden {
    display: none;
}

/* =========================================
   MOBILE RESPONSIVENESS (Media Queries)
   Only applies to screens smaller than 768px
   ========================================= */
@media (max-width: 768px) {

    /* 1. Fix the Intro Screen */
    #ui-layer {
        padding-left: 0;
        /* Remove side padding to use full width */
        justify-content: center;
        /* Center everything */
    }

    #intro-screen {
        max-width: 90%;
        /* Fit on screen */
        margin: 0 auto;
        /* Center horizontally */
        padding: 20px;
    }

    /* 2. Fix the "Person Detail" Page (The Letter & Photo) */
    .detail-body {
        flex-direction: column;
        /* Stack them top-to-bottom! */
        overflow-y: scroll;
        /* Allow scrolling */
        padding-bottom: 50px;
        /* Space for scrolling */
    }

    .detail-left {
        height: 250px;
        /* Limit image height */
        flex: none;
        /* Don't let it grow infinitely */
        margin-bottom: 20px;
    }

    #detail-img {
        object-fit: cover;
        /* Crop image nicely to fit box */
    }

    .detail-right {
        overflow: visible;
        /* Let text flow naturally */
    }

    /* 3. Fix the "City Gallery" Grid */
    #city-gallery {
        padding: 10px;
    }

    #gallery-grid {
        justify-content: center;
        gap: 10px;
    }

    .person-card {
        width: 45%;
        /* Show 2 cards per row instead of fixed pixel width */
        min-width: 140px;
        padding: 10px;
    }

    /* 4. Fix the Puzzle & Lock Screen */
    #puzzle-board {
        transform: scale(0.85);
        /* Shrink puzzle slightly to fit narrow screens */
        margin-bottom: 10px;
    }

    #puzzle-tray {
        width: 100%;
        gap: 2px;
    }

    .puzzle-piece {
        /* Make pieces slightly smaller in tray if needed */
        transform: scale(0.9);
    }

    /* 5. Make Buttons Finger-Friendly */
    button {
        padding: 15px 25px;
        /* Larger touch target */
        font-size: 18px;
    }
}

/* City View Extra Image */
.city-extra-image-container {
    margin-top: 20px;
    width: 100%;
    max-width: 300px;
    border: 1px solid var(--border-color);
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 2px;
}

.city-intro-extra-img {
    width: 100%;
    height: auto;
    display: block;
    opacity: 0.8;
    transition: opacity 0.3s ease;
}

.city-intro-extra-img:hover {
    opacity: 1;
}

.secondary-text {
    font-size: 1rem;
    padding: 0 10px;
    color: var(--text-muted);
    margin-bottom: 30px;
    font-style: italic;
    opacity: 0.8;
}

/* =========================================
   NEW SPLIT LAYOUT REFACTOR
   ========================================= */

/* 1. Main Container */
.city-layout-main {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    display: flex;
    flex-direction: row;
    /* Desktop Default: Left Text, Right Card */
    justify-content: space-between;
    align-items: center;
    padding: 0 4rem;
    /* px-16 equiv */
    box-sizing: border-box;
    overflow: hidden;
    pointer-events: none;
    /* Let clicks pass to map */
}

/* 2. Top Left Back Button */
.neon-back-btn {
    pointer-events: auto;
    position: absolute;
    top: 1.5rem;
    /* top-6 */
    left: 1.5rem;
    /* left-6 */
    z-index: 50;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: rgba(15, 23, 42, 0.5);
    /* bg-slate-900/50 */
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 9999px;
    color: white;
    font-family: var(--font-ui);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.2s;
}

.neon-back-btn:hover {
    background: rgba(255, 255, 255, 0.1);
}

.material-icon-back {
    font-size: 1.2rem;
    line-height: 1;
}

/* 3. Left Column - City Info */
.city-info-column {
    pointer-events: auto;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    max-width: 32rem;
    /* max-w-lg */
    z-index: 10;
    /* Added slight background for readability */
    padding: 20px;
    border-radius: 20px;
    /* background: radial-gradient(closest-side, rgba(0,0,0,0.5), transparent); */
}

.city-title-large {
    font-size: 4.5rem;
    /* text-7xl approx */
    font-weight: 900;
    color: white;
    margin: 0;
    line-height: 1.1;
    text-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    font-family: var(--font-body);
}

.city-subtitle {
    font-size: 1.125rem;
    /* text-lg */
    color: #cbd5e1;
    /* text-slate-300 */
    margin-top: 1rem;
    max-width: 28rem;
    /* max-w-md */
    font-family: var(--font-ui);
}

/* 4. Right Column - Command Card Wrapper */
.command-card-column {
    pointer-events: auto;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-end;
    z-index: 10;
    /* User: h-screen py-6 pr-6 */
    height: 100vh;
    padding: 1.5rem 10vw 1.5rem 0;
    /* Massive Right Padding (10vw) to pull card left */
    box-sizing: border-box;
}

/* The Glass Card Itself (Strict Sizing) */
.glass-card {
    width: 380px;
    height: auto;
    max-height: 85vh;
    /* HARD LIMIT: Never exceed 85% of screen height */
    background: rgba(15, 23, 42, 0.95);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 1.5rem;
    display: flex;
    flex-direction: column;
    box-shadow: 0 30px 60px -10px rgba(0, 0, 0, 0.6);
    overflow: hidden;
    /* Contain everything */
    flex-shrink: 0;
    /* Never collapse */
}

/* Internal Layout: STACKED (Robust) */

/* 1. Top: Connections */
.card-section-top {
    flex: none;
    padding: 12px;
    background: rgba(0, 0, 0, 0.3);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    overflow-x: auto;
    white-space: nowrap;
    height: 70px;
    /* Fixed height for thumbnails */
    display: flex;
    align-items: center;
}

/* 2. Middle: Scrollable Content Wrapper */
.card-section-middle {
    flex: 1;
    /* Takes remaining space */
    overflow-y: auto;
    /* Internal scroll if text is long */
    display: flex;
    flex-direction: column;
    position: relative;
    background: transparent;
}

/* 3. Image: Fixed Height at top of Middle Section */
#neon-main-img {
    position: relative;
    /* Not absolute */
    width: 100%;
    height: 220px;
    /* Fixed height */
    object-fit: cover;
    flex-shrink: 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

/* 4. Text Content: Below Image */
.neon-card-overlay-text {
    position: relative;
    /* Not absolute */
    padding: 20px;
    background: transparent;
    color: white;
}

#neon-person-name {
    font-size: 1.8rem;
    margin-bottom: 8px;
    color: white;
    font-weight: 700;
}

#neon-person-desc {
    font-size: 0.95rem;
    line-height: 1.5;
    color: #cbd5e1;
}

/* 5. Bottom: CTA Pinned */
.card-section-bottom {
    flex: none;
    padding: 16px;
    background: rgba(0, 0, 0, 0.4);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    z-index: 20;
}

#btn-enter-memory {
    width: 100%;
    padding: 1rem;
    letter-spacing: 1px;
    cursor: pointer;
    transition: transform 0.2s;
    /* RESTORED PREVIOUS DESIGN */
    background: transparent;
    color: var(--accent);
    border: 1px solid var(--accent);
    box-shadow: none;
}



#btn-enter-memory:hover {
    transform: scale(1.02);
    /* Restore Hover Gold */
    background: var(--accent);
    color: #000;
    box-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
}



/* 5. Mobile Responsiveness */
@media (max-width: 768px) {
    .city-layout-main {
        flex-direction: column;
        padding: 1rem;
        justify-content: flex-start;
        padding-top: 5rem;
        /* Space for back button */
    }

    .city-info-column {
        align-items: center;
        text-align: center;
        margin-bottom: 1rem;
    }

    .city-title-large {
        font-size: 3rem;
    }

    .command-card-column {
        width: 100%;
        align-items: center;
        justify-content: flex-start;
        padding: 0;
        height: auto;
        flex: 1;
        overflow-y: auto;
    }

    .glass-card {
        width: 100%;
        max-width: 380px;
        max-height: none;
        /* Let it flow on mobile */
    }
}

/* Audio Focus View (Jai) */
#audio-focus-view {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    padding: 20px;
}

#audio-focus-view.hidden {
    display: none;
}

.audio-center-card {
    background: rgba(20, 20, 20, 0.9);
    border: 1px solid var(--accent);
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
    padding: 30px;
    border-radius: 12px;
    width: 100%;
    max-width: 500px;
    text-align: center;
    color: var(--text-main);
}

.audio-center-card h2 {
    font-family: var(--font-header);
    color: var(--accent);
    margin-top: 0;
    margin-bottom: 20px;
}

.custom-audio-player {
    display: flex;
    align-items: center;
    gap: 15px;
    background: #000;
    padding: 10px 15px;
    border-radius: 50px;
    border: 1px solid #333;
    margin-bottom: 20px;
}

.af-btn {
    background: var(--accent);
    border: none;
    color: #000;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    font-size: 18px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.1s;
}

.af-btn:active {
    transform: scale(0.95);
}

.af-progress {
    flex: 1;
    cursor: pointer;
    accent-color: var(--accent);
}

#af-time {
    font-family: monospace;
    font-size: 14px;
    color: #fff;
}

.transcription-feed {
    text-align: left;
    background: rgba(255, 255, 255, 0.05);
    padding: 15px;
    border-radius: 8px;
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid #333;
}

.transcription-feed h3 {
    margin-top: 0;
    font-size: 14px;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 1px;
}

#af-transcription-text {
    font-style: italic;
    color: #ddd;
    line-height: 1.5;
    font-size: 16px;
    white-space: pre-wrap;
}

/* Right Side Audio Player (Dennis) */
#detail-audio-right {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
}

#detail-audio-right.hidden {
    display: none;
}

.right-audio-card {
    background: rgba(20, 20, 20, 0.6);
    padding: 20px;
    border-radius: 8px;
    width: 90%;
    text-align: center;
    border: 1px solid var(--accent);
}

.transcription-feed.small {
    max-height: 150px;
    font-size: 14px;
}

/* Video Focus View (Pronil) */
#video-focus-view {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    padding: 20px;
    background: #000;
}

#video-focus-view.hidden {
    display: none;
}

.video-center-container {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

#vf-video-element {
    max-width: 100%;
    max-height: 100%;
    border-radius: 8px;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
}

/* === UI LAYER === */
#ui-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 10;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* QUIZ CONTAINER */
.quiz-container {
    pointer-events: auto;
    background: rgba(35, 36, 37, 0.95);
    /* --bg-color transparent */
    padding: 40px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
    max-width: 600px;
    width: 90%;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(10px);
}

.step-title {
    font-family: var(--font-ui);
    color: #fff;
    /* White for headings per theme */
    font-size: 1.8rem;
    margin-bottom: 10px;
    text-align: center;
}

.step-desc {
    text-align: center;
    color: var(--text-secondary);
    margin-bottom: 30px;
}

/* BUTTONS (Hello Friend Style) */
button {
    font-family: var(--font-ui);
    font-weight: 600;
    border-radius: 5px;
    transition: all 0.2s ease;
}

.primary-btn {
    background: var(--bg-secondary);
    color: var(--text-main);
    border: 1px solid var(--border-color);
    padding: 12px 24px;
    font-size: 1rem;
    margin-top: 20px;
    width: 100%;
    cursor: pointer;
}

.primary-btn:hover {
    background: var(--text-main);
    /* Inverted hover effect common in minimalism */
    color: var(--bg-color);
    border-color: var(--text-main);
}

/* INPUTS */
.fintech-input-group label {
    display: block;
    font-family: var(--font-mono);
    font-size: 0.85rem;
    color: var(--text-secondary);
    margin-bottom: 5px;
}

.fintech-input {
    width: 100%;
    background: var(--bg-header);
    /* Darker input bg */
    border: 1px solid var(--border-color);
    color: var(--text-main);
    padding: 10px 15px;
    border-radius: 4px;
    font-family: var(--font-mono);
    font-size: 1rem;
    transition: border-color 0.2s;
}

.fintech-input:focus {
    outline: none;
    border-color: var(--accent);
    /* Minimal accent focus */
}

/* PERSONA GRID */
.persona-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
}

.persona-card {
    background: var(--bg-secondary);
    padding: 15px;
    border-radius: 6px;
    border: 1px solid transparent;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.persona-card:hover {
    transform: translateY(-2px);
    border-color: var(--text-secondary);
}

.persona-card h3 {
    font-size: 1rem;
    margin: 10px 0 5px 0;
    color: #fff;
}

.persona-card p {
    font-size: 0.8rem;
    color: var(--text-secondary);
}

/* Hide scrollbar for quiz content */
.quiz-content {
    max-height: 70vh;
    overflow-y: auto;
    padding-right: 5px;
}

/* =========================================
   SPEND-TREK FINTECH STYLES
   ========================================= */

.fintech-title {
    font-family: 'Courier New', monospace;
    font-size: 3rem;
    letter-spacing: -2px;
    margin-bottom: 0;
}

.year-badge {
    background: var(--accent);
    color: #000;
    font-size: 1rem;
    padding: 2px 8px;
    border-radius: 4px;
    vertical-align: super;
}

/* QUIZ GRID */
.quiz-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-top: 30px;
}

.quiz-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-color);
    padding: 15px;
    text-align: left;
    color: var(--text-main);
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: var(--font-ui);
}

.quiz-btn:hover {
    background: var(--accent);
    color: #000;
    transform: translateY(-2px);
}

.emoji {
    font-size: 1.5rem;
}

/* INPUT FORM GRID */
.input-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    margin: 30px 0;
    text-align: left;
}

.input-group label {
    display: block;
    color: var(--text-muted);
    font-size: 0.85rem;
    margin-bottom: 5px;
    font-family: var(--font-ui);
}

.input-group input {
    width: 100%;
    background: transparent;
    border: none;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-main);
    font-size: 1.2rem;
    padding: 5px 0;
    font-family: 'Courier New', monospace;
}

.input-group input:focus {
    outline: none;
    border-bottom-color: var(--accent);
}

#btn-analyze {
    width: 100%;
    background: var(--text-main);
    color: #000;
    font-weight: bold;
    padding: 20px;
    border: none;
    margin-top: 10px;
    font-family: 'Courier New', monospace;
    letter-spacing: 1px;
}

#btn-analyze:hover {
    background: #fff;
    box-shadow: 0 0 20px var(--accent);
}

/* Hide Utility */
.hidden {
    display: none !important;
}

/* Responsive */
@media (max-width: 600px) {

    .quiz-grid,
    .input-grid {
        grid-template-columns: 1fr;
    }
}

/* SPEND-TREK 2.0 TERMINAL STYLES (Added for Fix) */
.quiz-container {
    background: rgba(15, 15, 20, 0.95) !important;
    border: 1px solid var(--border-color);
    border-top: 3px solid var(--accent);
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);

    /* CRITICAL FIXES FOR INTERACTIVITY */
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10000 !important;
    /* === UI SCREEN 2: INPUT TERMINAL === */
}

#ui-input {
    z-index: 10;
    display: flex;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
}

.terminal-window {
    width: 95%;
    /* Wider for split view */
    max-width: 900px;
    background: rgba(10, 10, 10, 0.95);
    border: 1px solid var(--neon-green);
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
    border-radius: 8px;
    overflow: hidden;
    animation: slideUp 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    display: flex;
    flex-direction: column;
    max-height: 90vh;
    /* Prevent scrolling issues on small screens */
}

.terminal-header {
    background: #111;
    border-bottom: 1px solid var(--neon-green);
    padding: 10px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.terminal-body {
    padding: 20px;
    overflow-y: auto;
    color: var(--text-color);
    font-family: 'Rajdhani', sans-serif;
}

/* Split View for Form */
.split-view {
    display: flex;
    gap: 20px;
    margin-top: 15px;
}

.left-inputs {
    flex: 1;
    min-width: 300px;
    /* Ensure inputs don't get too squashed */
}

.right-vis {
    flex: 0.8;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    padding-top: 20px;
}

.chart-container {
    width: 100%;
    max-width: 300px;
    height: 300px;
    position: relative;
    margin-bottom: 20px;
}

@media (max-width: 768px) {
    .split-view {
        flex-direction: column;
    }

    .right-vis {
        order: 1;
    }
}


.console-log {
    font-family: 'Courier New', Courier, monospace;
    font-size: 0.9em;
    margin-bottom: 20px;
    opacity: 0.8;
}

.form-group-row {
    display: flex;
    gap: 20px;
}

.form-group {
    margin-bottom: 15px;
    flex: 1;
}

label {
    display: block;
    font-size: 0.8em;
    color: var(--neon-green);
    margin-bottom: 5px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* Calculator Amount Display */
.calc-amt {
    float: right;
    color: var(--neon-blue);
    font-weight: bold;
}

input[type="text"],
input[type="number"],
select {
    width: 100%;
    background: #222;
    border: 1px solid #444;
    color: #fff;
    padding: 10px;
    font-family: 'Rajdhani', sans-serif;
    font-size: 1em;
    border-radius: 4px;
}

input:focus,
select:focus {
    outline: none;
    border-color: var(--neon-green);
    box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
}

.divider {
    height: 1px;
    background: #333;
    margin: 20px 0;
}

.section-title {
    color: var(--neon-blue);
    font-size: 1.1em;
    margin-bottom: 5px;
    border-left: 3px solid var(--neon-blue);
    padding-left: 10px;
}

.section-subtitle {
    color: #888;
    font-size: 0.85em;
    margin-bottom: 15px;
    padding-left: 13px;
}

.slider-group {
    margin-bottom: 12px;
    margin-bottom: 20px;
}

.slider-row {
    display: flex;
    align-items: center;
    gap: 15px;
    position: relative;
    padding: 10px 0;
}

/* Base Slider Reset */
input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    background: transparent;
    cursor: pointer;
    margin: 0;
}

input[type="range"]:focus {
    outline: none;
}

/* === Webkit (Chrome/Safari) === */
input[type="range"]::-webkit-slider-runnable-track {
    width: 100%;
    height: 6px;
    background: #333;
    /* Base rail color */
    border-radius: 4px;
    cursor: pointer;
    /* transition: background 0.2s; - Removing transition for instant JS updates to avoid lag feel */
}

/* The Thumb */
input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    height: 20px;
    width: 20px;
    border-radius: 50%;
    background: #fff;
    border: 2px solid var(--neon-green);
    cursor: pointer;
    margin-top: -7px;
    /* Center thumb on track (6px track height / 2 - 20px thumb height / 2) */
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    transition: transform 0.1s ease, box-shadow 0.1s ease;
}

input[type="range"]:focus::-webkit-slider-thumb {
    box-shadow: 0 0 15px var(--neon-green);
    transform: scale(1.1);
}

/* === Firefox === */
input[type="range"]::-moz-range-track {
    width: 100%;
    height: 6px;
    background: #333;
    border-radius: 4px;
    cursor: pointer;
}

input[type="range"]::-moz-range-thumb {
    height: 20px;
    width: 20px;
    border: 2px solid var(--neon-green);
    border-radius: 50%;
    background: #fff;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
}

/* Savings Specific Colors override via JS or specialized class if needed, 
   but for now we use the dynamic styling in JS to change track color. */

.slider-val {
    min-width: 45px;
    text-align: right;
    font-weight: bold;
    color: var(--neon-green);
    font-family: 'Fira Code', monospace;
    font-size: 1.1em;
}

.total-status {
    text-align: right;
    font-weight: bold;
    margin-top: 10px;
    font-size: 1.1em;
    padding: 10px;
    background: #000;
    border: 1px dashed #555;
    border-radius: 4px;
    width: 100%;
    text-align: center;
}

.btn-process {
    width: 100%;
    margin-top: 20px;
    padding: 15px;
    background: var(--neon-green);
    color: #000;
    border: none;
    font-family: 'Orbitron', sans-serif;
    font-weight: bold;
    font-size: 1.2em;
    letter-spacing: 2px;
    cursor: pointer;
    clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
    transition: all 0.3s ease;
}

.btn-process:hover {
    background: #fff;
    box-shadow: 0 0 20px var(--neon-green);
}

.terminal-header {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border-color);
    align-items: center;
}

.dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    display: inline-block;
}

.dot.red {
    background: #ff5f56;
}

.dot.yellow {
    background: #ffbd2e;
}

.dot.green {
    background: #27c93f;
}

.title {
    margin-left: 10px;
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--text-secondary);
}

.input-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.input-group {
    margin-bottom: 15px;
    text-align: left;
}

.input-group label {
    display: block;
    font-family: var(--font-mono);
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-bottom: 5px;
}

.input-group input {
    width: 100%;
    background: #111;
    border: 1px solid #444;
    color: var(--accent);
    padding: 10px;
    font-family: var(--font-mono);
    font-size: 1rem;
    border-radius: 4px;
}

.input-group input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 10px rgba(255, 205, 0, 0.2);
}

.primary-btn {
    background: var(--accent);
    color: #000;
    border: none;
    padding: 15px;
    font-family: var(--font-mono);
    font-weight: bold;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.2s;
    text-transform: uppercase;
}

.primary-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 205, 0, 0.4);
}

/* 3D CANVAS LAYER */
#canvas-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    /* Low Z-index to sit behind UI */
    pointer-events: auto !important;
    /* Enable interactions (OrbitControls) */
}

/* UI LAYER INTERACTION FIXES */
#ui-result {
    pointer-events: none !important;
    /* Allow clicks to pass through empty space */
}

#ui-result .result-card {
    pointer-events: auto !important;
    /* Capture clicks on the card itself */
}

/* SIMPLIFIED 3-SCREEN FLOW STYLES */

.ui-screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    /* Center */
    z-index: 100;
    pointer-events: none;
    overflow: hidden;
    /* Prevent container scroll, force child scroll */
}

/* Allow pass-through for BG interaction if needed */
/* Allow pass-through for BG interaction if needed */

/* Enable pointer events on the content windows */
.splash-content,
.terminal-window {
    pointer-events: auto !important;
}

/* SPLASH SCREEN */
.splash-content {
    text-align: center;
    backdrop-filter: blur(10px);
    padding: 50px;
    border-radius: 20px;
    background: rgba(0, 0, 0, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.glitch-title {
    font-family: 'Fira Code', monospace;
    font-size: 4rem;
    color: var(--text-main);
    margin: 0;
}

.badge {
    background: var(--accent);
    color: #000;
    padding: 0 10px;
    border-radius: 5px;
    font-size: 0.5em;
    vertical-align: middle;
}

.subtitle {
    color: var(--text-secondary);
    font-size: 1.5rem;
    margin-top: 10px;
}

.pulse-btn {
    margin-top: 30px;
    padding: 15px 40px;
    font-size: 1.2rem;
    background: var(--accent);
    color: #000;
    border: none;
    cursor: pointer;
    font-family: 'Fira Code', monospace;
    font-weight: bold;
    box-shadow: 0 0 20px rgba(255, 205, 0, 0.4);
    transition: transform 0.2s;
}

.pulse-btn:hover {
    transform: scale(1.05);
}

/* TERMINAL & RESULT WINDOWS */
.terminal-window {
    background: rgba(20, 20, 25, 0.95);
    border: 1px solid var(--border-color);
    border-top: 4px solid var(--accent);
    padding: 30px;
    border-radius: 10px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
}

.grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

/* RESULT STYLES */
.result-window {
    max-width: 600px;
    /* Slightly wider */
}

.result-header {
    text-align: center;
    margin-bottom: 20px;
}

.result-stats {
    display: flex;
    justify-content: space-around;
    margin: 20px 0;
}

.stat-box {
    background: rgba(255, 255, 255, 0.05);
    padding: 15px;
    border-radius: 8px;
    text-align: center;
    min-width: 120px;
}

.stat-box span {
    font-size: 0.8rem;
    color: #888;
    text-transform: uppercase;
}

.stat-box h3 {
    margin: 5px 0 0;
    font-size: 1.4rem;
}

.nuska-box {
    background: rgba(255, 205, 0, 0.1);
    border: 1px solid var(--accent);
    padding: 20px;
    margin-top: 20px;
    border-radius: 8px;
}

.action-btn {
    width: 100%;
    background: var(--accent);
    border: none;
    padding: 12px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 10px;
}

.restart-btn {
    width: 100%;
    background: transparent;
    border: none;
    color: #666;
    margin-top: 20px;
    cursor: pointer;
}

.restart-btn:hover {
    color: #fff;
}


/* V6 STYLES FOR TRANSPARENT LOGIC */

.terminal-select {
    width: 100%;
    background: #111;
    border: 1px solid #444;
    color: var(--accent);
    padding: 10px;
    font-family: var(--font-mono);
    font-size: 1rem;
    border-radius: 4px;
}

.processing-window {
    text-align: center;
    background: rgba(0, 0, 0, 0.8);
    padding: 30px;
    border-radius: 10px;
    border: 1px solid var(--accent);
    box-shadow: 0 0 30px rgba(255, 205, 0, 0.2);
    min-width: 300px;
}

.loader-circle {
    width: 50px;
    height: 50px;
    border: 3px solid rgba(255, 255, 255, 0.1);
    border-top: 3px solid var(--accent);
    border-radius: 50%;
    margin: 0 auto 20px;
    animation: spin 1s linear infinite;
}

.console-log {
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    color: var(--text-secondary);
    text-align: left;
    height: 60px;
    overflow: hidden;
}

/* V6 RESULT CARD */
.result-window-v6 {
    background: rgba(20, 20, 25, 0.95);
    border: 1px solid var(--border-color);
    border-top: 4px solid var(--accent);
    padding: 20px;
    border-radius: 10px;
    width: 95%;
    max-width: 900px;
    /* Wider for 3 columns */
    display: grid;
    grid-template-columns: 1fr 1.2fr 1fr;
    /* Persona | Logic | Solution */
    gap: 20px;
    color: #fff;
}

.col-persona {
    text-align: center;
    border-right: 1px solid var(--border-color);
    padding-right: 20px;
}

.col-logic {
    border-right: 1px solid var(--border-color);
    padding-right: 20px;
}

.col-solution {
    text-align: center;
}

.logic-item {
    margin-bottom: 15px;
    background: rgba(255, 255, 255, 0.05);
    padding: 10px;
    border-radius: 4px;
}

.logic-label {
    font-size: 0.75rem;
    color: #888;
    text-transform: uppercase;
    display: block;
    margin-bottom: 4px;
}

.logic-value {
    font-size: 0.9rem;
    color: #ddd;
}

.logic-highlight {
    color: var(--accent);
    font-weight: bold;
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

@media (max-width: 800px) {
    .result-window-v6 {
        grid-template-columns: 1fr;
        max-height: 80vh;
        overflow-y: auto;
    }

    .col-persona,
    .col-logic {
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 20px;
    }
}

/* Highlight Animation for Chart Interaction */
@keyframes highlightPulse {
    0% {
        box-shadow: 0 0 0 0 rgba(0, 255, 65, 0.7);
        border-color: var(--neon-green);
    }

    70% {
        box-shadow: 0 0 0 10px rgba(0, 255, 65, 0);
        border-color: var(--neon-green);
    }

    100% {
        box-shadow: 0 0 0 0 rgba(0, 255, 65, 0);
        border-color: transparent;
    }
}

.highlight-pulse {
    animation: highlightPulse 1s ease-out;
    border-radius: 8px;
    border: 1px solid transparent;
}

/* === Mobile Responsiveness === */
@media screen and (max-width: 768px) {

    /* 1. Reset Container Widths */
    .terminal-window {
        width: 100%;
        max-width: 100%;
        height: 100vh;
        margin: 0;
        border-radius: 0;
        padding: 15px;
        overflow-y: auto;
    }

    /* 2. Stack the Split View */
    .split-view {
        flex-direction: column-reverse;
        /* Inputs first, Chart follows */
        flex-direction: column;
        height: auto;
        overflow: visible;
    }

    /* 3. Adjust Sections */
    .left-inputs,
    .right-vis {
        flex: none;
        width: 100%;
        padding: 0;
        border: none;
        overflow: visible;
    }

    .left-inputs {
        margin-bottom: 30px;
    }

    /* 4. Optimize Chart Container for Mobile */
    .right-vis {
        height: 300px;
        border-top: 2px dashed var(--border-color);
        padding-top: 20px;
        margin-top: 20px;
    }

    .chart-container {
        height: 250px;
    }

    /* 5. Typography & Touch Targets */
    .glitch-title {
        font-size: 2.0rem;
        line-height: 1.2;
    }

    .subtitle {
        font-size: 1rem;
    }

    input[type="range"]::-webkit-slider-thumb {
        width: 24px;
        height: 24px;
        margin-top: -9px;
    }

    .btn-process {
        padding: 20px;
        font-size: 1.1rem;
        margin-bottom: 40px;
    }
}